# Руководство пользователя системы ценообразования ERP

## Введение

Это руководство поможет вам эффективно использовать систему ценообразования ERP для расчета цен на продукцию с учетом всех параметров и модификаторов.

## Быстрый старт

### Основные понятия

**Базовая цена** - исходная цена продукта из каталога
**Модификатор** - правило, изменяющее базовую цену
**unitPrice** - цена за единицу измерения после модификаторов
**modifiedUnitPrice** - итоговая цена с учетом размеров изделия

## Работа с модификаторами

### Создание нового модификатора

1. Перейдите в раздел "Модификаторы цен"
2. Нажмите "Создать модификатор"
3. Заполните обязательные поля:
   - **Название** - понятное описание
   - **Код** - уникальный идентификатор
   - **Тип** - один из 5 доступных типов
   - **Значение** - числовое значение модификатора
   - **Приоритет** - порядок применения (меньше = раньше)

### Типы модификаторов

#### 1. Фиксированная сумма (FIXED_AMOUNT)
**Когда использовать:** Для добавления конкретной суммы
**Пример:** "+1000 руб за декоративную филенку"

#### 2. Процент (PERCENTAGE)
**Когда использовать:** Для процентных надбавок/скидок
**Пример:** "-15% сезонная скидка"

#### 3. Множитель (MULTIPLIER)
**Когда использовать:** Для коэффициентов наценки
**Пример:** "×1.3 за премиальный материал"

#### 4. Фиксированная цена (FIXED_PRICE)
**Когда использовать:** Для установки конкретной цены
**Пример:** "Фиксированная цена 5000 руб"

#### 5. За единицу (PER_UNIT)
**Когда использовать:** Для альтернативного ценообразования
**Пример:** "2000 руб за 1 м²"

## Условия применения

### Простые условия
Выберите свойство и его значение:
```
Свойство: "Модель"
Значение: "Вероника"
```

### Сложные условия
Используйте SQL-подобный синтаксис:
```
propertyValue > 3000 AND propertyValue LIKE 'цвет:%'
```

### Поддерживаемые операторы:
- `=` , `!=` - равенство/неравенство
- `<` , `>` , `<=` , `>=` - сравнения
- `LIKE` - поиск по шаблону (% - любой символ)
- `IN` - вхождение в список
- `BETWEEN` - в диапазоне
- `AND` , `OR` , `NOT` - логические операции

## Расчет цен

### Через API

**Endpoint:** `POST /price-modifiers/calculate`

**Пример запроса:**
```json
{
  "basePrice": 1500,
  "quantity": 10,
  "unit": 1.6,
  "coefficient": 1.2,
  "propertyValues": [
    {
      "propertyId": 1,
      "value": "премиум"
    },
    {
      "propertyId": 2, 
      "value": "массив_дуб"
    }
  ]
}
```

**Пример ответа:**
```json
{
  "basePrice": 1500,
  "unitPrice": 3900,
  "modifiedUnitPrice": 6240,
  "finalPrice": 74880,
  "appliedModifiers": [
    {
      "modifierName": "Премиум серия",
      "modifierType": "MULTIPLIER",
      "value": 1.3,
      "priceImpact": 1950
    }
  ]
}
```

## Практические примеры

### Пример 1: Расчет кухонного фасада

**Исходные данные:**
- Продукт: Фасад кухни
- Базовая цена: 1500 руб/м²
- Размеры: 2.0м × 0.8м
- Модель: "Вероника" (+1000 руб)
- Материал: массив дуба (×1.3)

**Расчет:**
1. Базовая цена: 1500 руб/м²
2. Модель "Вероника": 1500 + 1000 = 2500 руб/м²
3. Массив дуба: 2500 × 1.3 = 3250 руб/м² (unitPrice)
4. Размеры: 3250 × 1.6 = 5200 руб (modifiedUnitPrice)
5. Итого за 10 шт: 5200 × 10 = 52000 руб

### Пример 2: Плинтус

**Исходные данные:**
- Продукт: Плинтус
- Базовая цена: 200 руб/п.м.
- Длина: 4.0 п.м.
- Цвет: белый (-5%)

**Расчет:**
1. Базовая цена: 200 руб/п.м.
2. Скидка за цвет: 200 × 0.95 = 190 руб/п.м. (unitPrice)
3. Длина: 190 × 4.0 = 760 руб (modifiedUnitPrice)
4. Итого за 5 шт: 760 × 5 = 3800 руб

## Работа с заказами

### Добавление позиций с автоматическим расчетом

1. Создайте заказ
2. Добавьте секцию
3. При добавлении позиции система автоматически:
   - Рассчитывает цену с учетом всех модификаторов
   - Применяет размеры изделия
   - Учитывает коэффициенты и количество

### Редактирование свойств позиции

При изменении свойств позиции:
- Система пересчитывает цену
- Показывает примененные модификаторы
- Обновляет итоговую стоимость заказа

## Мониторинг и отчеты

### Просмотр примененных модификаторов

В деталях каждой позиции отображается:
- Список примененных модификаторов
- Влияние каждого модификатора на цену
- Итоговый расчет по шагам

### Анализ эффективности

Система предоставляет метрики:
- Частота использования модификаторов
- Средние скидки по категориям
- Эффективность promotional кампаний

## Решение проблем

### Распространенные ошибки

**"Цена не изменилась после добавления модификатора"**
- Проверьте условия применения модификатора
- Убедитесь, что свойства продукта соответствуют условиям

**"Слишком большая скидка"**
- Система ограничивает скидки 90% от базовой цены
- Проверьте комбинацию нескольких модификаторов

**"Модификатор не применяется"**
- Проверьте приоритет модификатора
- Убедитесь в корректности условий

### Отладка расчетов

1. Используйте режим отладки API
2. Просматривайте логи применения модификаторов
3. Проверяйте значения свойств продукта

## Советы по эффективному использованию

### Оптимизация модификаторов

1. **Группируйте связанные модификаторы** по приоритетам
2. **Используйте сложные условия** для точной настройки
3. **Регулярно проверяйте** эффективность модификаторов
4. **Документируйте** бизнес-логику каждого модификатора

### Лучшие практики

- Создавайте модификаторы с понятными названиями
- Используйте систему приоритетов логично
- Тестируйте новые модификаторы перед применением
- Регулярно архивируйте неиспользуемые модификаторы

## Поддержка

При возникновении вопросов:
1. Проверьте эту документацию
2. Обратитесь к технической поддержке
3. Используйте систему тикетов для сложных запросов

---
*Документ обновлен: Январь 2026*
*Версия: 1.0*

**Контакты поддержки:**
- Email: support@myuger.ru
- Телефон: +7 (XXX) XXX-XX-XX
- Внутренний чат: #support-pricing