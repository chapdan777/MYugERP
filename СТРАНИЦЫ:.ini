СТРАНИЦЫ:
1. Страница заказа
У заказов должна быть возможность печати заявки с возможностью скрывания некоторых столбцов: для производства вообще без цен, для клиента только со стоимостью и для менеджера полный. 
Заказ:
Заказ (верхняяя шапка) - это не заявка в работу для фасадов. Это любой документ на производстве. В нем могут быть фасады, мебель, профиль, прием материалов на производство (входящая заявка), заказ материалов на склад и т.д. Т.е это универсальный формат документа.
Типа заказа – заполняется из списка
Дата оформления – автоматически, дата создания заказа (остальные даты редактирования фиксируются в истории заказа)
Дата запуска – когда заказ принят в работу 
Дата выполнения заказа – автоматически, от даты принятия в работу  Выбирается из списка (Месяц, Неделя) или вводится вручную в днях. А в БД записывается дата дедлайн
Клиент - заполняется вручную или автоматически заполняется при авторизованном клиенте или выбирается из таблицы Люди с Типом: Клиент (менеджером)
Наименование – заполняется вручную
Номер заказа (ID) – формируется по порядку
Менеджерa - у нас работает так: кто сохранил заявку тот и папа. А в истории сохраняется на какой стадии кто сохранял
От – дата получения заказа на почту или в мессенджере
Шапка:
Во второй шапке с доп.свойствами должно быть реализовано их отключение или включение в зависимости от типа заказа. Если вспомнишь, ты делал такое, только тогда было, что если ты их получал, то отображал, а если нет, то перегруппировал.

Материал заказа - заполняется из списка 
Модель фасада - заполняется из списка
Филенка - заполняется из списка
Материал филенки - заполняется автоматически с возможностью изменения
Текстура - заполняется из списка
Цвет - заполняется вручную
Патина - заполняется из списка
Глянцевость - заполняется вручную
Дополнительные параметры отделки – заполняется вручную
Присадка - чекбокс 
Термошов - чекбокс
Комментарий - заполняется вручную
Площадь заказа - заполняется автоматически сумма площадей в таблице (не выделять. Техническое поле)
Тело:
Состоит из 2  нескольких таблиц (Фасадные элементы, Дополнительные элементы - согласно типу номенклатуры), а также поля ввода данных в таблицу.
Каждая таблица состоит из:
Столбцы таблицы: Номенклатура | длина | ширина | кол-во | площадь/погонный метр | Цена (Видно менеджеру) | Коэффициент (Видно менеджеру) | Стоимость | примечание | Кнопка разворачивания номенклатуры
Площадь считается длина * высоту * количество с округлением до сотых в большую сторону.
Погонный метр считается длина * количество Погонный метр - условная единица. Для расчетов материалов отделки, расходников и т.д все равно необходима площадь. Но для этого нужно ввести условную ширину для изделий в п.м.

Каждая номенклатура должна разворачиваться и в ней будет чек-лист доп.свойств взятых из шапки, а также свойства, которые стоят с параметром IsActive: false
Строку таблицы можно добавить новую или скопировать прошлую.
_____________________
2. Страница добавления номенклатур, их свойств и цен, а также добавление списков (доступ к ним только по ссылке)
Состоит из вкладок:
- Номенклатуры (добавление, изменение и удаление номенклатуры, ее цена, добавление свойств к ней)
- Свойства номенклатуры (добавление, изменение и удаление свойств, и привязка значений к свойству)
- Значения свойств номенклатуры (добавление, удаление и изменение свойств)

3. Страница списка заказов с отображением ключевых доп.свойств для быстрой идентификации заказа. Столбцы с доп.свойствами при появлении авторизации должны отключаться по правам. 
Вид страницы на данный момент:


4. Страница пользователей (добавление, удаление)
Состоит из списка пользователей, и имеет функции удаления, изменения данных пользователя и добавление нового пользователя 
5. Страница добавления шапок заказа
Список готовых шапок, добавление новой шапки, а также привязка к шапке разных свойств номенклатуры.
6. Страница управления зависимостями между значениями свойств номенклатуры


ТАБЛИЦЫ БАЗЫ ДАННЫХ:
Список шапок заказа
Table headersOrder {
  id integer [primary key]
  name varchar
}
Список шапок для формы заказов
Свойства привязанные к шапке заказа
Table propertyInHeader {
  id integer [primary key]
  headerID varchar
  propertyID integer
}


Ref: "headersOrder"."name" < "propertyInHeader"."headerID"


Ref: "property"."id" < "propertyInHeader"."propertyID"


Список свойств привязанных к шапке заказа.
Номенклатуры


Table product {
  id integer [primary key]
  name varchar
  category varchar
  description varchar
  unit varchar
  length int          -- Длина по умолчанию
  width int           -- Ширина по умолчанию
  depth int           -- Глубина по умолчанию
}
Состоит из ИД, наименование, категории, описания и ед.изм.
Добавил поля длина, ширина, глубина для значений по умолчанию. Например, у нас карнизы имеют постоянную высоту и глубину, а меняется только ширина. 
Связь номенклатуры и доп свойств




Table productProperty {
  id integer [primary key]
  productID integer
  propertyID integer
  active bit
  defaultValue varchar  -- Новое поле для хранения значения по умолчанию
}


Ref: "productProperty"."productID" < "product"."id"
Ref: "productProperty"."propertyID" < "property"."id"




Для того чтобы правильно определить для какой позиции в заказе относится то или иное свойство шапки существует эта таблица. Свойство IsActive создано для того чтобы указать какие свойства будут включены для номенклатуры по умолчанию при добавлении ее в заказ. Идея в том, чтобы при небольшом изменении стандартной номенклатуры не создавать новую, а просто добавить в справочнике доп.свойство с параметром IsActive: false и включать это доп.свойство только там, где это необходимо. Реализацию этого я представлял, как поп-ап, который открывается при нажатии на кнопку возле номенклатуры или двойном клике на нее. Сразу с новым доп.свойством мы получим новую работу в заказ наряде и автоматическое добавление к стоимости взятое из таблицы модификаторов прайса.
Добавил поле для значений по умолчанию. Например, если мы знаем, что данное свойство в 80% случаев  имеет одинаковое значение, то можем сразу загружать его из БД с этим значением (ну пусть будет)
 Доп. свойства номенклатуры
Table property {
  id integer [primary key]
  name varchar
}

Ref: "product"."id" < "property"."productID"


Наша шапка, помимо информации о заказе, состоит из доп.свойств которые  относятся к позициям внутри заказа. Также некоторые доп.свойства могут указываться непосредственно у самой номенклатуры.
Вариации значений доп. свойств (списки)
Table propertyValue {
  id integer [primary key]
  propertyID integer
  value varchar
}

Ref: "propertyValue"."propertyID" < "property"."id"


Эта таблица содержит данные для некоторых доп. свойств. Это значит, что, если в данном списке есть какое-то доп. свойство, значит мы для него можем сразу создавать список.






Описание полей
id: Уникальный идентификатор записи.
propertyID: Ссылка на ID основного свойства (например, "Модель").
propertyValue: Значение основного свойства (например, "Модель A").
dependentPropertyID: Ссылка на ID зависимого свойства (например, "Ширина профиля").
dependentValue: Значение зависимого свойства (например, "10 см").
Пример использования
Если у вас есть свойство "Модель" с идентификатором 1 и значение "Модель A", и вы хотите, чтобы при выборе этой модели ширина профиля автоматически устанавливала значение "10 см", вы создаете запись в таблице propertyValueDependencies.

Если у вас есть другое значение "Модель B" и ширина профиля должна быть "15 см", вы создаете еще одну запись.


Table propertyValueDep {
  id integer [primary key]
  propertyID integer
  propertyValueID integer
  propertyValue varchar
  propertyDepID integer
  propertyDepValueID integer
  propertyDepValue varchar
}


Ref: "property"."id" < "propertyValueDep"."id"


Ref: "property"."id" < "propertyValueDep"."propertyDepID"


Ref: "propertyValue"."id" < "propertyValueDep"."propertyValueID"


Ref: "propertyValue"."id" < "propertyValueDep"."propertyDepValueID"


Прайс
Table price {
  id integer [primary key]
  productID integer
  price int
}

Ref: "product"."id" < "price"."productID"


Данная концепция подразумевает, что мы указываем базовую стоимость номенклатуры, а все остальное указываем модификаторами. Это нам позволяет очень быстро поменять цену  тут и она автоматически изменится во всех вариациях данной модели. К примеру, мы имеем номенклатуру Фасад Глухой у которой есть доп.свойство модель. Так вот базовая цена фасада глухого может быть 9000руб, а доп.свойство модель=Бергонци +1000 (итого 9000+1000=10000), а  доп.свойство модель=Алиери +2000 (итого 9000+2000=11000). В итоге, изменив базовую стоимость с 9000 до 10000 мы автоматически получим изменение цены на всех 80 моделях фасадов. 
Идея этого пришла из-за очень сложного редактирования прайса с большим кол-вом моделей.  
Модификаторов цены
Table modify {
  id integer [primary key]
  propertyID integer
  propertyValueID integer
  price int
}

Ref: "propertyValue"."id" < "modify"."propertyValueID"


Ref: "property"."id" < "modify"."propertyID"







Модификатор связан с свойством и его значением 
ИНФОРМАЦИЯ О ПОЛЬЗОВАТЕЛЯХ
Пользователи
Table users {
  id integer [primary key]
  username varchar
  fullname varchar
  date_birtday varchar
  roleID integer
  created_at timestamp
}

Ref: "users"."roleID" < "usersRole"."id"
Таблица для создания людей всех типов: Работник, Клиент, Менеджер и т.д.
Роли пользователей
Table usersRole {
  id integer [primary key]
  name varchar
}


Роли пользователей
Работник, Клиент, Менеджер и т.д.







Доп. данные о пользователях
Table usersProperty {
  id integer [primary key]
  userID integer
  type varchar
  value varchar
  note varchar
}

Ref: "users"."id" < "usersProperty"."userID"


Так как у разной категории людей разные данные, я подумал, что можно вынести данные в дополнительную таблицу. Это нам позволяет создать два-три номера телефона или отдельные данные для разных категорий.
ИНФОРМАЦИЯ О ЗАКАЗЕ
Заказ
Table order {
  id integer [primary key]
  numberOrder int
  typeOrder varchar
  nameOrder varchar
  dateOrder varchar
  dateStart varchar
  dateComplite varchar
  agentID integer
  clientID integer
  square varchar
  note varchar
}




Ref: "users"."id" < "order"."clientID"


Ref: "users"."id" < "order"."agentID"
В данной таблице хранятся основные данные о заказе и связаны они с клиентом и менеджером
Шапка заказа (Удалена)
Table headerOrder {
  id integer [primary key]
  orderID integer
  property varchar
  square varchar
  note varchar
}



Ref: "propertyValue"."id" < "headerOrder"."orderMaterial"


Ref: "propertyValue"."id" < "headerOrder"."modelFasad"


Ref: "propertyValue"."id" < "headerOrder"."modelFilenka"


Ref: "propertyValue"."id" < "headerOrder"."materialFilenka"


Ref: "propertyValue"."id" < "headerOrder"."color"


Ref: "propertyValue"."id" < "headerOrder"."gloss"


Ref: "propertyValue"."id" < "headerOrder"."texture"


Ref: "propertyValue"."id" < "headerOrder"."prisadka"


Ref: "propertyValue"."id" < "headerOrder"."termoshov"


Ref: "propertyValue"."id" < "headerOrder"."patina"



Не вижу теперь в ней необходимости
Номенклатуры в заказе
Table productinorder {
  id integer [primary key]
  orderID integer
  productID integer
  productName varchar
  length int
  width int
  quantity int
  price int
  coefficient int
  totalPrice int
  square varchar
  note varchar
}


Ref: "productinorder"."productID" < "product"."id"


Ref: "productinorder"."orderID" < "order"."id"  




Список ссылок на номенклатуры, связанные в заказ а так же некоторые постоянные данные относящиеся к ней.
Свойства в заказе
Table propertyInOrder {
  id integer [primary key]
  orderID integer
  productInOrderID integer
  propertyID integer
  value varchar
}


Ref: "order"."id" < "propertyInOrder"."orderID"


Ref: "productinorder"."id" < "propertyInOrder"."productInOrderID"


Ref: "property"."id" < "propertyInOrder"."propertyID"


В этой таблице хранятся свойства связи
Заказа со значениям свойств в нем, а также связи Номенклатуры в заказе и значений свойств связанных с ней
Логирование
Table log {
  id integer [primary key]
  orderID integer
  userID int
  date varchar
  note varchar
}

Ref: "users"."id" < "log"."userID"


Ref: "order"."id" < "log"."orderID"


Система записи изменений в заказе с сохранением пользователя, даты, а также описание функции, в которой было изменение.





